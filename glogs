#!/bin/bash
# uses goaccess to summarize nginx logs

cd /var/log/nginx

case "$1" in
status)
	[ -z "$2" ] && echo "specify HTTP status as second argument" && exit 1
	awk -v field=$2 '$9 == field {print}' access.log
	;;
raw)
	# just print the logs
	cat access.log
	;;
recent)
	# goaccess terminal recent logs
	tail -f -n +1 access.log | goaccess --log-format=COMBINED -
	;;
all)
	# goaccess terminal all logs
	tail -f -n +1 access.log | goaccess --log-format=COMBINED -
	;;
*)
	echo "Must specify 'recent', 'all', 'raw', 'status' as argument"
	exit 1
	;;
esac

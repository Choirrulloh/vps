#!/bin/bash
# uses goaccess to summarize nginx logs
# glogs html is run every hour with:
# 0 */1 * * * /home/sean/vps/glogs html
# /var/www/html/logs/index.html is symlinked to ~/.goaccess.html

cd /var/log/nginx
case "$1" in
recent)
	tail -f -n +1 access.log | goaccess --log-format=COMBINED -
	;;
all)
	{ zcat access.log.*.gz && tail -f -n +1 access.log; } | goaccess --log-format=COMBINED -
	;;
html)
	{ zcat access.log.*.gz && cat access.log; } | goaccess --log-format=COMBINED -o "${HOME}/.goaccess.html" -
	;;
*)
	echo "Must specify 'recent', 'all', or 'html' as argument"
	exit 1
	;;
esac
